<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BibTeX Copy - Fixed Version Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .debug-info {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 1em;
            margin: 1em 0;
            font-family: monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <h1>BibTeX Copy åŠŸèƒ½ - ä¿®å¤ç‰ˆæœ¬æµ‹è¯•</h1>
    
    <div class="debug-info">
        <h3>ğŸ” ç¯å¢ƒæ£€æµ‹ï¼š</h3>
        <p><strong>HTTPS:</strong> <span id="https-status"></span></p>
        <p><strong>Clipboard API:</strong> <span id="clipboard-status"></span></p>
        <p><strong>execCommand:</strong> <span id="execcommand-status"></span></p>
        <p><strong>User Agent:</strong> <span id="user-agent"></span></p>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 1: å• BibTeX å—</h2>
        <div class="bibtex-box" style="margin-top:1em;border:1px solid #e0e0e0;border-radius:4px;padding:1em;background:#fafafa;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5em;">
                <span style="font-size:smaller;color:#0066cc;font-weight:600;">
                    <i class="fas fa-quote-left" aria-hidden="true"></i> BibTeX
                </span>
                <button class="bibtex-copy-btn" type="button" aria-label="Copy BibTeX"
                    style="padding:0.3em 0.8em;background:#0066cc;color:#fff;border:none;border-radius:3px;cursor:pointer;font-size:0.85em;transition:all .2s;box-shadow:0 2px 4px rgba(0,0,0,.1);">
                    <i class="fas fa-copy" aria-hidden="true"></i> Copy
                </button>
            </div>
            <pre class="bibtex-content" style="background:#f4f4f4;padding:1em;margin:0;border-radius:4px;font-size:0.85em;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;">@article{wu2024swattention,
  title={SWattention: designing fast and memory-efficient attention for a new Sunway Supercomputer},
  author={Wu, Ruohan and Zhu, Xianyu and Chen, Junshi and Liu, Sha and Zheng, Tianyu and Liu, Xin and An, Hong},
  journal={The Journal of Supercomputing},
  year={2024},
  publisher={Springer}
}</pre>
        </div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 2: å¤š BibTeX å—</h2>
        
        <div class="bibtex-box" style="margin-top:1em;border:1px solid #e0e0e0;border-radius:4px;padding:1em;background:#fafafa;">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:0.5em;">
                <span style="font-size:smaller;color:#0066cc;font-weight:600;">
                    <i class="fas fa-quote-left" aria-hidden="true"></i> BibTeX
                </span>
                <button class="bibtex-copy-btn" type="button" aria-label="Copy BibTeX"
                    style="padding:0.3em 0.8em;background:#0066cc;color:#fff;border:none;border-radius:3px;cursor:pointer;font-size:0.85em;transition:all .2s;box-shadow:0 2px 4px rgba(0,0,0,.1);">
                    <i class="fas fa-copy" aria-hidden="true"></i> Copy
                </button>
            </div>
            <pre class="bibtex-content" style="background:#f4f4f4;padding:1em;margin:0;border-radius:4px;font-size:0.85em;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word;">@article{wu2025swformer,
  title={SwFormer: Enabling Faster Foundation Models on new Sunway Supercomputer via Holistic Kernel Tiling and Scheduling},
  author={Wu, Ruohan and Zhu, Xianyu and Chen, Junshi and An, Hong},
  journal={Journal of Computer Science and Technology},
  year={2025},
  publisher={Springer}
}</pre>
        </div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 3: å¤åˆ¶éªŒè¯</h2>
        <p>ç‚¹å‡»ä¸Šé¢çš„ Copy æŒ‰é’®ï¼Œç„¶ååœ¨è¿™é‡Œç²˜è´´ (Ctrl+V æˆ– Cmd+V) æ¥éªŒè¯å¤åˆ¶æ˜¯å¦æˆåŠŸï¼š</p>
        <textarea id="paste-test" placeholder="åœ¨è¿™é‡Œç²˜è´´æµ‹è¯•å¤åˆ¶çš„å†…å®¹..." 
                  style="width: 100%; height: 120px; margin-top: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 4px;"></textarea>
        <div id="test-result" style="margin-top: 10px; padding: 10px; border-radius: 4px; display: none;"></div>
    </div>

    <div class="test-section">
        <h2>æµ‹è¯• 4: æ§åˆ¶å°æ—¥å¿—</h2>
        <p>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12) æŸ¥çœ‹æ§åˆ¶å°ï¼Œåº”è¯¥èƒ½çœ‹åˆ°è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ã€‚</p>
        <button onclick="showConsoleInfo()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
            æ˜¾ç¤ºæ§åˆ¶å°ä¿¡æ¯
        </button>
        <div id="console-info" style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 4px; display: none;"></div>
    </div>

    <!-- ä½¿ç”¨å¤–é“¾è„šæœ¬ -->
    <script src="assets/js/bibtex-copy.js" defer></script>

    <script>
        // ç¯å¢ƒæ£€æµ‹
        document.getElementById('https-status').textContent = window.isSecureContext ? 'âœ… æ˜¯' : 'âŒ å¦';
        document.getElementById('clipboard-status').textContent = !!(navigator.clipboard && navigator.clipboard.writeText) ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨';
        document.getElementById('execcommand-status').textContent = document.queryCommandSupported ? 'âœ… å¯ç”¨' : 'âŒ ä¸å¯ç”¨';
        document.getElementById('user-agent').textContent = navigator.userAgent;

        // ç²˜è´´æµ‹è¯•
        document.getElementById('paste-test').addEventListener('paste', function(e) {
            setTimeout(() => {
                const pastedText = e.target.value;
                const resultDiv = document.getElementById('test-result');
                
                if (pastedText.includes('@article{wu2024swattention') || pastedText.includes('@article{wu2025swformer')) {
                    resultDiv.style.background = '#d4edda';
                    resultDiv.style.border = '1px solid #c3e6cb';
                    resultDiv.style.color = '#155724';
                    resultDiv.innerHTML = 'âœ… å¤åˆ¶æµ‹è¯•æˆåŠŸï¼å†…å®¹å·²æ­£ç¡®å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚';
                } else {
                    resultDiv.style.background = '#f8d7da';
                    resultDiv.style.border = '1px solid #f5c6cb';
                    resultDiv.style.color = '#721c24';
                    resultDiv.innerHTML = 'âŒ å¤åˆ¶æµ‹è¯•å¤±è´¥ï¼Œå†…å®¹ä¸åŒ¹é…æˆ–ä¸ºç©ºã€‚';
                }
                resultDiv.style.display = 'block';
            }, 100);
        });

        function showConsoleInfo() {
            const info = document.getElementById('console-info');
            info.innerHTML = `
                <h4>æ§åˆ¶å°åº”è¯¥æ˜¾ç¤ºçš„ä¿¡æ¯ï¼š</h4>
                <ul>
                    <li>BibTeX copy button found, adding event listener</li>
                    <li>Copy button clicked</li>
                    <li>Using Clipboard API æˆ– Using fallback method</li>
                    <li>Copy successful æˆ–ç›¸å…³é”™è¯¯ä¿¡æ¯</li>
                </ul>
                <p><strong>å¦‚æœæ²¡æœ‰çœ‹åˆ°è¿™äº›ä¿¡æ¯ï¼Œè¯´æ˜è„šæœ¬æ²¡æœ‰æ­£ç¡®åŠ è½½æˆ–æ‰§è¡Œã€‚</strong></p>
            `;
            info.style.display = 'block';
        }
    </script>
</body>
</html>